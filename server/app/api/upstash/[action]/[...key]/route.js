(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[162],{2067:e=>{"use strict";e.exports=require("node:async_hooks")},6195:e=>{"use strict";e.exports=require("node:buffer")},6836:(e,t,o)=>{"use strict";o.r(t),o.d(t,{ComponentMod:()=>E,default:()=>O});var a={};o.r(a),o.d(a,{GET:()=>c,OPTIONS:()=>h,POST:()=>l,runtime:()=>y});var s={};o.r(s),o.d(s,{headerHooks:()=>x,originalPathname:()=>P,patchFetch:()=>b,requestAsyncStorage:()=>f,routeModule:()=>k,serverHooks:()=>m,staticGenerationAsyncStorage:()=>g,staticGenerationBailout:()=>w});var r=o(7875),n=o(8381),u=o(2251),i=o(9845),d=o(572);async function p(e,{params:t}){let o=new URL(e.url).searchParams.get("endpoint");if("OPTIONS"===e.method)return d.xk.json({body:"OK"},{status:200});let[...a]=t.key;if(!o||!new URL(o).hostname.endsWith(".upstash.io"))return d.xk.json({error:!0,msg:"you are not allowed to request "+t.key.join("/")},{status:403});if("get"!==t.action&&"set"!==t.action)return console.log("[Upstash Route] forbidden action ",t.action),d.xk.json({error:!0,msg:"you are not allowed to request "+t.action},{status:403});let s=`${o}/${t.action}/${t.key.join("/")}`,r=e.method,n=["get","head"].includes(r?.toLowerCase()??""),u={headers:{authorization:e.headers.get("authorization")??""},body:n?null:e.body,method:r,duplex:"half"};console.log("[Upstash Proxy]",s,u);let i=await fetch(s,u);return console.log("[Any Proxy]",s,{status:i.status,statusText:i.statusText}),i}let l=p,c=p,h=p,y="edge",k=new n.AppRouteRouteModule({definition:{kind:u.x.APP_ROUTE,page:"/api/upstash/[action]/[...key]/route",pathname:"/api/upstash/[action]/[...key]",filename:"route",bundlePath:"app/api/upstash/[action]/[...key]/route"},resolvedPagePath:"/Users/peterzhang/dev/github/docker-wordpress/Luomor-Next-Web/app/api/upstash/[action]/[...key]/route.ts",nextConfigOutput:"standalone",userland:a}),{requestAsyncStorage:f,staticGenerationAsyncStorage:g,serverHooks:m,headerHooks:x,staticGenerationBailout:w}=k,P="/api/upstash/[action]/[...key]/route";function b(){return(0,i.XH)({serverHooks:m,staticGenerationAsyncStorage:g})}let E=s,O=r.a.wrap(k)}},e=>{var t=t=>e(e.s=t);e.O(0,[297],()=>t(6836));var o=e.O();(_ENTRIES="undefined"==typeof _ENTRIES?{}:_ENTRIES)["middleware_app/api/upstash/[action]/[...key]/route"]=o}]);
//# sourceMappingURL=route.js.map